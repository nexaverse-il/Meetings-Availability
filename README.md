# Airtable Meeting Availability Automation

◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊ú◊†◊ô◊î◊ï◊ú ◊ñ◊û◊†◊ô ◊§◊í◊ô◊©◊ï◊™ ◊ë◊î◊™◊ê◊ù ◊ú◊î◊í◊ì◊®◊ï◊™ ◊û◊ï◊™◊ê◊û◊ï◊™ ◊ê◊ô◊©◊ô◊™ ◊ë◊°◊ë◊ô◊ë◊™ Airtable. ◊î◊û◊¢◊®◊õ◊™ ◊û◊ô◊ô◊¶◊®◊™ ◊ë◊ê◊ï◊§◊ü ◊ê◊ï◊ò◊ï◊û◊ò◊ô ◊ó◊ú◊ï◊†◊ï◊™ ◊ñ◊û◊ü ◊§◊†◊ï◊ô◊ô◊ù ◊ú◊§◊í◊ô◊©◊ï◊™ ◊ú◊§◊ô ◊©◊¢◊ï◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊û◊ï◊í◊ì◊®◊ï◊™.

üõ† ◊©◊ô◊û◊ï◊©
◊ô◊¶◊ô◊®◊î ◊ê◊ï◊ò◊ï◊û◊ò◊ô◊™ ◊ô◊ï◊û◊ô◊™
◊î◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊™◊®◊ï◊• ◊ë◊ê◊ï◊§◊ü ◊ê◊ï◊ò◊ï◊û◊ò◊ô ◊û◊ì◊ô ◊ô◊ï◊ù ◊ë-6:00 ◊ë◊ë◊ï◊ß◊® ◊ï◊™◊ô◊¶◊ï◊® ◊ê◊™ ◊ó◊ú◊ï◊†◊ï◊™ ◊î◊ñ◊û◊ü ◊î◊§◊†◊ï◊ô◊ô◊ù ◊ú◊ê◊ï◊™◊ï ◊ô◊ï◊ù ◊ë◊î◊™◊ê◊ù ◊ú◊î◊í◊ì◊®◊ï◊™ ◊©◊ë◊ò◊ë◊ú◊™ Business Research.
◊ô◊¶◊ô◊®◊î ◊û◊®◊ï◊õ◊ñ◊™ ◊ú◊ò◊ï◊ï◊ó ◊™◊ê◊®◊ô◊õ◊ô◊ù
◊ê◊ù ◊ë◊®◊¶◊ï◊†◊ö ◊ú◊ô◊¶◊ï◊® ◊ó◊ú◊ï◊†◊ï◊™ ◊ñ◊û◊ü ◊ú◊ò◊ï◊ï◊ó ◊™◊ê◊®◊ô◊õ◊ô◊ù ◊ê◊®◊ï◊ö ◊ô◊ï◊™◊®:

◊î◊í◊ì◊® ◊ê◊™ "Generate Time Slots Until" ◊ú◊™◊ê◊®◊ô◊ö ◊î◊°◊ô◊ï◊ù ◊î◊®◊¶◊ï◊ô
◊°◊û◊ü ◊ê◊™ ◊™◊ô◊ë◊™ ◊î◊°◊ô◊û◊ï◊ü "Generate Time Slots"
◊î◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊î◊ô◊ô◊¢◊ï◊ì◊ô◊™ ◊™◊®◊ï◊• ◊ï◊™◊ô◊¶◊ï◊® ◊ê◊™ ◊õ◊ú ◊ó◊ú◊ï◊†◊ï◊™ ◊î◊ñ◊û◊ü ◊¢◊ì ◊ú◊™◊ê◊®◊ô◊ö ◊©◊î◊ï◊í◊ì◊®

## üåü ◊°◊ß◊ô◊®◊î ◊õ◊ú◊ú◊ô◊™

◊û◊¢◊®◊õ◊™ ◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊ñ◊ï ◊û◊ê◊§◊©◊®◊™ ◊ú◊ö ◊ú◊î◊í◊ì◊ô◊® ◊©◊¢◊ï◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ò◊ë◊ú◊™ ◊î◊í◊ì◊®◊ï◊™, ◊ï◊î◊û◊¢◊®◊õ◊™ ◊™◊ô◊¶◊ï◊® ◊ë◊ê◊ï◊§◊ü ◊ê◊ï◊ò◊ï◊û◊ò◊ô ◊ó◊ú◊ï◊†◊ï◊™ ◊ñ◊û◊ü ◊§◊†◊ï◊ô◊ô◊ù ◊ú◊§◊í◊ô◊©◊ï◊™ ◊ë◊ò◊ë◊ú◊™ ◊ñ◊û◊ô◊†◊ï◊™. ◊†◊ô◊™◊ü ◊ú◊î◊í◊ì◊ô◊®:

- ◊©◊¢◊ï◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ú◊õ◊ú ◊ô◊ï◊ù ◊ë◊©◊ë◊ï◊¢
- ◊û◊©◊ö ◊ñ◊û◊ü ◊ú◊õ◊ú ◊§◊í◊ô◊©◊î
- ◊î◊ê◊ù ◊ô◊ï◊ù ◊û◊°◊ï◊ô◊ù ◊§◊¢◊ô◊ú ◊ê◊ï ◊ú◊ê

◊î◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊§◊ï◊¢◊ú◊™ ◊ë◊õ◊ú ◊ô◊ï◊ù ◊ë-6:00 ◊ë◊ë◊ï◊ß◊® ◊ï◊ô◊ï◊¶◊®◊™ ◊ê◊™ ◊ó◊ú◊ï◊†◊ï◊™ ◊î◊ñ◊û◊ü ◊ú◊ô◊ï◊ù ◊î◊†◊ï◊õ◊ó◊ô ◊ë◊ú◊ë◊ì, ◊õ◊ì◊ô ◊ú◊©◊û◊ï◊® ◊¢◊ú ◊ò◊ë◊ú◊™ ◊î◊ñ◊û◊ô◊†◊ï◊™ ◊†◊ß◊ô◊ô◊î ◊ï◊û◊¢◊ï◊ì◊õ◊†◊™.

## üìã ◊ì◊®◊ô◊©◊ï◊™ ◊û◊ß◊ì◊ô◊û◊ï◊™

- ◊ó◊©◊ë◊ï◊ü Airtable
- ◊î◊®◊©◊ê◊ï◊™ ◊ú◊ô◊¶◊ô◊®◊™ ◊ê◊ï◊ò◊ï◊û◊¶◊ô◊ï◊™
- ◊©◊™◊ô ◊ò◊ë◊ú◊ê◊ï◊™ ◊ë-Base:
  - `Business Research ‚öôÔ∏è` - ◊ú◊î◊í◊ì◊®◊ï◊™ ◊©◊¢◊ï◊™ ◊§◊¢◊ô◊ú◊ï◊™
  - `Meetings Availabilityüåª` - ◊ú◊ñ◊û◊†◊ô ◊î◊§◊í◊ô◊©◊ï◊™ ◊î◊§◊†◊ï◊ô◊ô◊ù

## üîß ◊î◊í◊ì◊®◊î

### 1. ◊î◊í◊ì◊®◊™ ◊ò◊ë◊ú◊™ Business Research

◊î◊ï◊°◊£ ◊ê◊™ ◊î◊©◊ì◊ï◊™ ◊î◊ë◊ê◊ô◊ù ◊ú◊ò◊ë◊ú◊™ `Business Research ‚öôÔ∏è`:

| ◊©◊ì◊î | ◊°◊ï◊í | ◊™◊ô◊ê◊ï◊® |
|------|------|--------|
| Availability Settings Active | Checkbox | ◊î◊ê◊ù ◊î◊í◊ì◊®◊ï◊™ ◊î◊ñ◊û◊ô◊†◊ï◊™ ◊§◊¢◊ô◊ú◊ï◊™ |
| Default Meeting Duration | Duration | ◊û◊©◊ö ◊î◊ñ◊û◊ü ◊î◊°◊ò◊†◊ì◊®◊ò◊ô ◊ú◊§◊í◊ô◊©◊î |
| Sunday Active | Checkbox | ◊î◊ê◊ù ◊ô◊ï◊ù ◊®◊ê◊©◊ï◊ü ◊§◊¢◊ô◊ú |
| Sunday Start Time | Single line text | ◊©◊¢◊™ ◊î◊™◊ó◊ú◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊®◊ê◊©◊ï◊ü (◊§◊ï◊®◊û◊ò: HH:MM) |
| Sunday End Time | Single line text | ◊©◊¢◊™ ◊°◊ô◊ï◊ù ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊®◊ê◊©◊ï◊ü (◊§◊ï◊®◊û◊ò: HH:MM) |
| Monday Active | Checkbox | ◊î◊ê◊ù ◊ô◊ï◊ù ◊©◊†◊ô ◊§◊¢◊ô◊ú |
| Monday Start Time | Single line text | ◊©◊¢◊™ ◊î◊™◊ó◊ú◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊†◊ô |
| Monday End Time | Single line text | ◊©◊¢◊™ ◊°◊ô◊ï◊ù ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊†◊ô |
| Tuesday Active | Checkbox | ◊î◊ê◊ù ◊ô◊ï◊ù ◊©◊ú◊ô◊©◊ô ◊§◊¢◊ô◊ú |
| Tuesday Start Time | Single line text | ◊©◊¢◊™ ◊î◊™◊ó◊ú◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊ú◊ô◊©◊ô |
| Tuesday End Time | Single line text | ◊©◊¢◊™ ◊°◊ô◊ï◊ù ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊ú◊ô◊©◊ô |
| Wednesday Active | Checkbox | ◊î◊ê◊ù ◊ô◊ï◊ù ◊®◊ë◊ô◊¢◊ô ◊§◊¢◊ô◊ú |
| Wednesday Start Time | Single line text | ◊©◊¢◊™ ◊î◊™◊ó◊ú◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊®◊ë◊ô◊¢◊ô |
| Wednesday End Time | Single line text | ◊©◊¢◊™ ◊°◊ô◊ï◊ù ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊®◊ë◊ô◊¢◊ô |
| Thursday Active | Checkbox | ◊î◊ê◊ù ◊ô◊ï◊ù ◊ó◊û◊ô◊©◊ô ◊§◊¢◊ô◊ú |
| Thursday Start Time | Single line text | ◊©◊¢◊™ ◊î◊™◊ó◊ú◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊ó◊û◊ô◊©◊ô |
| Thursday End Time | Single line text | ◊©◊¢◊™ ◊°◊ô◊ï◊ù ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊ó◊û◊ô◊©◊ô |
| Friday Active | Checkbox | ◊î◊ê◊ù ◊ô◊ï◊ù ◊©◊ô◊©◊ô ◊§◊¢◊ô◊ú |
| Friday Start Time | Single line text | ◊©◊¢◊™ ◊î◊™◊ó◊ú◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊ô◊©◊ô |
| Friday End Time | Single line text | ◊©◊¢◊™ ◊°◊ô◊ï◊ù ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊ô◊©◊ô |
| Saturday Active | Checkbox | ◊î◊ê◊ù ◊ô◊ï◊ù ◊©◊ë◊™ ◊§◊¢◊ô◊ú |
| Saturday Start Time | Single line text | ◊©◊¢◊™ ◊î◊™◊ó◊ú◊™ ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊ë◊™ |
| Saturday End Time | Single line text | ◊©◊¢◊™ ◊°◊ô◊ï◊ù ◊§◊¢◊ô◊ú◊ï◊™ ◊ë◊ô◊ï◊ù ◊©◊ë◊™ |
| Generate Time Slots | Checkbox | ◊°◊û◊ü ◊õ◊ì◊ô ◊ú◊î◊§◊¢◊ô◊ú ◊ô◊ô◊¶◊ï◊® ◊û◊ô◊ô◊ì◊ô ◊©◊ú ◊ó◊ú◊ï◊†◊ï◊™ ◊ñ◊û◊ü |
| Generate Time Slots Until | Date | ◊™◊ê◊®◊ô◊ö ◊°◊ô◊ï◊ù ◊ú◊ô◊ô◊¶◊ï◊® ◊û◊®◊ï◊õ◊ñ ◊©◊ú ◊ó◊ú◊ï◊†◊ï◊™ ◊ñ◊û◊ü |

### 2. ◊î◊í◊ì◊®◊™ ◊ò◊ë◊ú◊™ Meetings Availability

◊ï◊ì◊ê ◊©◊ò◊ë◊ú◊™ `Meetings Availabilityüåª` ◊õ◊ï◊ú◊ú◊™ ◊ê◊™ ◊î◊©◊ì◊ï◊™ ◊î◊ë◊ê◊ô◊ù:

| ◊©◊ì◊î | ◊°◊ï◊í | ◊™◊ô◊ê◊ï◊® |
|------|------|--------|
| Time Slots | Date & Time | ◊™◊ê◊®◊ô◊ö ◊ï◊©◊¢◊î ◊©◊ú ◊ó◊ú◊ï◊ü ◊î◊ñ◊û◊ü ◊î◊§◊†◊ï◊ô |
| Dration‚è≥ | Duration | ◊û◊©◊ö ◊î◊ñ◊û◊ü ◊©◊ú ◊ó◊ú◊ï◊ü ◊î◊ñ◊û◊ü ◊î◊§◊†◊ï◊ô |
| Notes üìã | Long text | ◊î◊¢◊®◊ï◊™ ◊ê◊ï◊§◊¶◊ô◊ï◊†◊ú◊ô◊ï◊™ |
| Scheduled Meetings ü§ù | Link to another record | ◊ß◊ô◊©◊ï◊® ◊ú◊§◊í◊ô◊©◊ï◊™ ◊©◊†◊ß◊ë◊¢◊ï |
| Leads üß≤ | Link to another record | ◊ß◊ô◊©◊ï◊® ◊ú◊ú◊ô◊ì◊ô◊ù |
| Clients üåü | Link to another record | ◊ß◊ô◊©◊ï◊® ◊ú◊ú◊ß◊ï◊ó◊ï◊™ |

### 3. ◊î◊í◊ì◊®◊™ ◊î◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊î◊ô◊ï◊û◊ô◊™

1. ◊¶◊ï◊® ◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊ó◊ì◊©◊î ◊ë-Airtable
2. ◊î◊í◊ì◊® ◊ò◊®◊ô◊í◊® "At scheduled time" 
3. ◊ë◊ó◊® ◊ë◊°◊ï◊í ◊û◊®◊ï◊ï◊ó "Days" ◊ï◊ß◊ë◊¢ ◊ê◊™ ◊î◊û◊®◊ï◊ï◊ó ◊ú-1 (◊õ◊ú ◊ô◊ï◊ù)
4. ◊ß◊ë◊¢ ◊ê◊™ ◊©◊¢◊™ ◊î◊î◊§◊¢◊ú◊î ◊ú-6:00 ◊ë◊ë◊ï◊ß◊®
5. ◊î◊ï◊°◊£ ◊¶◊¢◊ì "Run script" ◊ï◊î◊¢◊™◊ß ◊ê◊™ ◊ß◊ï◊ì ◊î◊ê◊ï◊ò◊ï◊û◊¶◊ô◊î ◊î◊ô◊ï◊û◊ô◊™ ◊û◊î◊ß◊ï◊ë◊• `daily-availability-generator.js`

## üìù ◊î◊ß◊ï◊ì◊ô◊ù

### `daily-availability-generator.js`

◊°◊ß◊®◊ô◊§◊ò ◊ñ◊î ◊û◊ô◊ô◊¶◊® ◊ó◊ú◊ï◊†◊ï◊™ ◊ñ◊û◊ü ◊§◊†◊ï◊ô◊ô◊ù ◊ú◊§◊í◊ô◊©◊ï◊™ ◊¢◊ë◊ï◊® ◊î◊ô◊ï◊ù ◊î◊†◊ï◊õ◊ó◊ô ◊ë◊ú◊ë◊ì, ◊¢◊ú ◊§◊ô ◊î◊í◊ì◊®◊ï◊™ ◊©◊¢◊ï◊™ ◊î◊§◊¢◊ô◊ú◊ï◊™:

```javascript
// Get business research record
const businessResearchTable = base.getTable('Business Research ‚öôÔ∏è');
const meetingsAvailabilityTable = base.getTable('Meetings Availabilityüåª');

// Helper function for output that works in any environment
function logOutput(message) {
    console.log(message);
    
    // Try different output methods depending on environment
    try {
        if (typeof output !== 'undefined' && output.text) {
            output.text(message);
        }
    } catch (e) {
        // Ignore errors with output methods
    }
}

// Query for active business research records
const query = await businessResearchTable.selectRecordsAsync({
    filterByFormula: "{Availability Settings Active} = TRUE()"
});

if (query.records.length === 0) {
    logOutput("No records with active availability settings found. Aborting.");
    return;
}

// Use the first matching record
const record = query.records[0];

// Get time slots configuration
const defaultDuration = record.getCellValue('Default Meeting Duration') 
    ? record.getCellValue('Default Meeting Duration').seconds 
    : 1800; // default 30 minutes

// Get current date (run only for today)
const today = new Date();
const dayOfWeek = today.getDay();

// Check if we have settings for this day
const daysConfig = {
    0: { // Sunday
        active: record.getCellValue('Sunday Active'),
        startTime: record.getCellValue('Sunday Start Time'),
        endTime: record.getCellValue('Sunday End Time')
    },
    1: { // Monday
        active: record.getCellValue('Monday Active'),
        startTime: record.getCellValue('Monday Start Time'),
        endTime: record.getCellValue('Monday End Time')
    },
    2: { // Tuesday
        active: record.getCellValue('Tuesday Active'),
        startTime: record.getCellValue('Tuesday Start Time'),
        endTime: record.getCellValue('Tuesday End Time')
    },
    3: { // Wednesday
        active: record.getCellValue('Wednesday Active'),
        startTime: record.getCellValue('Wednesday Start Time'),
        endTime: record.getCellValue('Wednesday End Time')
    },
    4: { // Thursday
        active: record.getCellValue('Thursday Active'),
        startTime: record.getCellValue('Thursday Start Time'),
        endTime: record.getCellValue('Thursday End Time')
    },
    5: { // Friday
        active: record.getCellValue('Friday Active'),
        startTime: record.getCellValue('Friday Start Time'),
        endTime: record.getCellValue('Friday End Time')
    },
    6: { // Saturday
        active: record.getCellValue('Saturday Active'),
        startTime: record.getCellValue('Saturday Start Time'),
        endTime: record.getCellValue('Saturday End Time')
    }
};

const dayConfig = daysConfig[dayOfWeek];

// Skip if this day is not active or missing time settings
if (!dayConfig.active || !dayConfig.startTime || !dayConfig.endTime) {
    const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
    logOutput(`Today (${dayNames[dayOfWeek]}) is not an active day or has incomplete time settings. Skipping.`);
    return;
}

// Time slots to create
const timeSlots = [];

// Parse start and end times
const [startHour, startMinute] = dayConfig.startTime.split(':').map(Number);
const [endHour, endMinute] = dayConfig.endTime.split(':').map(Number);

// Create DateTime objects for today's start and end times
const startDateTime = new Date(today);
startDateTime.setHours(startHour, startMinute, 0, 0);

const endDateTime = new Date(today);
endDateTime.setHours(endHour, endMinute, 0, 0);

// If current time is after the start time, adjust the start time to be the next slot
const now = new Date();
if (now > startDateTime) {
    // Calculate the next available time slot
    const minutesSinceStart = Math.floor((now - startDateTime) / 1000 / 60);
    const slotsSinceStart = Math.ceil(minutesSinceStart / (defaultDuration / 60));
    const additionalMinutes = slotsSinceStart * (defaultDuration / 60);
    
    startDateTime.setMinutes(startDateTime.getMinutes() + additionalMinutes);
    
    // If the adjusted start time is after end time, there are no more slots for today
    if (startDateTime >= endDateTime) {
        logOutput("No more available time slots for today.");
        return;
    }
}

// Generate time slots for today
for (let slotTime = new Date(startDateTime); slotTime < endDateTime; slotTime.setSeconds(slotTime.getSeconds() + defaultDuration)) {
    // Skip slots that have already passed
    if (slotTime > now) {
        timeSlots.push({
            fields: {
                'Time Slots': slotTime.toISOString(),
                'Dration‚è≥': defaultDuration
            }
        });
    }
}

if (timeSlots.length === 0) {
    logOutput("No future time slots available for today.");
    return;
}

// Create records in batches of 50 (Airtable limit)
const batchSize = 50;
let createdCount = 0;
for (let i = 0; i < timeSlots.length; i += batchSize) {
    const batch = timeSlots.slice(i, i + batchSize);
    const result = await meetingsAvailabilityTable.createRecordsAsync(batch);
    createdCount += result.length;
    logOutput(`Created batch ${Math.floor(i/batchSize) + 1} of ${Math.ceil(timeSlots.length/batchSize)} (${createdCount}/${timeSlots.length} slots)`);
}

const resultMessage = `Created ${timeSlots.length} meeting availability slots for today (${today.toLocaleDateString()}).`;
logOutput(resultMessage);


bulk-availability-generator.js
◊°◊ß◊®◊ô◊§◊ò ◊ñ◊î ◊û◊ô◊ô◊¶◊® ◊ó◊ú◊ï◊†◊ï◊™ ◊ñ◊û◊ü ◊§◊†◊ï◊ô◊ô◊ù ◊ú◊§◊í◊ô◊©◊ï◊™ ◊ú◊ò◊ï◊ï◊ó ◊™◊ê◊®◊ô◊õ◊ô◊ù ◊ê◊®◊ï◊ö, ◊ú◊§◊ô ◊î◊í◊ì◊®◊ï◊™ ◊©◊¢◊ï◊™ ◊î◊§◊¢◊ô◊ú◊ï◊™:

// Get business research record
const businessResearchTable = base.getTable('Business Research ‚öôÔ∏è');
const meetingsAvailabilityTable = base.getTable('Meetings Availabilityüåª');

// Helper function for output that works in any environment
function logOutput(message) {
    console.log(message);
    
    // Try different output methods depending on environment
    try {
        if (typeof output !== 'undefined' && output.text) {
            output.text(message);
        }
    } catch (e) {
        // Ignore errors with output methods
    }
}

// Query for records with Generate Time Slots = true
const query = await businessResearchTable.selectRecordsAsync({
    filterByFormula: "{Generate Time Slots} = TRUE()"
});

if (query.records.length === 0) {
    logOutput("No records with Generate Time Slots set to true found. Aborting.");
    return;
}

// Use the first matching record
const record = query.records[0];
const recordId = record.id;

// Check if the trigger is active
if (!record.getCellValue('Availability Settings Active')) {
    logOutput('Availability settings are not active. Aborting.');
    return;
}

// Get time slots configuration
const defaultDuration = record.getCellValue('Default Meeting Duration') 
    ? record.getCellValue('Default Meeting Duration').seconds 
    : 1800; // default 30 minutes

const endDate = new Date(record.getCellValue('Generate Time Slots Until'));
const currentDate = new Date();

// Days configuration
const daysConfig = {
    0: { // Sunday
        active: record.getCellValue('Sunday Active'),
        startTime: record.getCellValue('Sunday Start Time'),
        endTime: record.getCellValue('Sunday End Time')
    },
    1: { // Monday
        active: record.getCellValue('Monday Active'),
        startTime: record.getCellValue('Monday Start Time'),
        endTime: record.getCellValue('Monday End Time')
    },
    2: { // Tuesday
        active: record.getCellValue('Tuesday Active'),
        startTime: record.getCellValue('Tuesday Start Time'),
        endTime: record.getCellValue('Tuesday End Time')
    },
    3: { // Wednesday
        active: record.getCellValue('Wednesday Active'),
        startTime: record.getCellValue('Wednesday Start Time'),
        endTime: record.getCellValue('Wednesday End Time')
    },
    4: { // Thursday
        active: record.getCellValue('Thursday Active'),
        startTime: record.getCellValue('Thursday Start Time'),
        endTime: record.getCellValue('Thursday End Time')
    },
    5: { // Friday
        active: record.getCellValue('Friday Active'),
        startTime: record.getCellValue('Friday Start Time'),
        endTime: record.getCellValue('Friday End Time')
    },
    6: { // Saturday
        active: record.getCellValue('Saturday Active'),
        startTime: record.getCellValue('Saturday Start Time'),
        endTime: record.getCellValue('Saturday End Time')
    }
};

// Time slots to create
const timeSlots = [];

// Loop through each day from today until the end date
for (let date = new Date(currentDate); date <= endDate; date.setDate(date.getDate() + 1)) {
    const dayOfWeek = date.getDay();
    const dayConfig = daysConfig[dayOfWeek];
    
    // Skip if this day is not active or missing time settings
    if (!dayConfig.active || !dayConfig.startTime || !dayConfig.endTime) {
        continue;
    }
    
    // Parse start and end times
    const [startHour, startMinute] = dayConfig.startTime.split(':').map(Number);
    const [endHour, endMinute] = dayConfig.endTime.split(':').map(Number);
    
    // Create DateTime objects for this day's start and end times
    const startDateTime = new Date(date);
    startDateTime.setHours(startHour, startMinute, 0, 0);
    
    const endDateTime = new Date(date);
    endDateTime.setHours(endHour, endMinute, 0, 0);
    
    // Generate time slots for this day
    for (let slotTime = new Date(startDateTime); slotTime < endDateTime; slotTime.setSeconds(slotTime.getSeconds() + defaultDuration)) {
        timeSlots.push({
            fields: {
                'Time Slots': slotTime.toISOString(),
                'Dration‚è≥': defaultDuration
            }
        });
    }
}

// Create records in batches of 50 (Airtable limit)
const batchSize = 50;
let createdCount = 0;
for (let i = 0; i < timeSlots.length; i += batchSize) {
    const batch = timeSlots.slice(i, i + batchSize);
    const result = await meetingsAvailabilityTable.createRecordsAsync(batch);
    createdCount += result.length;
    logOutput(`Created batch ${Math.floor(i/batchSize) + 1} of ${Math.ceil(timeSlots.length/batchSize)} (${createdCount}/${timeSlots.length} slots)`);
}

// Reset the trigger field
await businessResearchTable.updateRecordAsync(recordId, {
    'Generate Time Slots': false
});

const resultMessage = `Created ${timeSlots.length} meeting availability slots from ${currentDate.toLocaleDateString()} to ${endDate.toLocaleDateString()}.`;
logOutput(resultMessage);



◊§◊ï◊™◊ó ◊¢"◊ô ◊ô◊ê◊ô◊® ◊ó◊§◊• ◊¢◊ë◊ï◊® ◊†◊ß◊°◊ê◊ë◊®◊°
